<!DOCTYPE html>
<html lang="en">

<head>
    <title>Admin Panel</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" type="image/png" href="images/icons/favicon.ico" />

    <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">

    <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">

    <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">

    <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">

    <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">

    <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">

    <link rel="stylesheet" type="text/css" href="css/util.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">

    <meta name="robots" content="noindex, follow">
</head>

<body>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edit Modal</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
      	<div class="container">
<center>
  <h1>Edit Products</h1>
</center>
<div class="mb-3" >
  <img src=""	style="width:200px; height:200px;" id="EditFilePreview"></img>
</div>
<div class="mb-3">
  <label for="EditName" class="form-label">Product Name</label>
  <input type="text" class="form-control" id="EditName" placeholder="Example:- Mobile, Computer">
</div>
<div class="mb-3">
  <label for="EditPrice" class="form-label">Product Price</label>
  <input type="tel" class="form-control" id="EditPrice" placeholder="Example:- 100">
</div>
<div class="mb-3">
  <label for="EditType" class="form-label">Product Type</label>
  <input type="text" class="form-control" id="EditType" placeholder="Example:- wired, wireless">
</div>
<div class="mb-3">
  <label for="EditColor" class="form-label">Product Color</label>
  <input type="text" class="form-control" id="EditColor" placeholder="Example:- white, black">
</div>
<div class="mb-3">
  <label for="EditMetarial" class="form-label">Product Material</label>
  <input type="text" class="form-control" id="EditMetarial" placeholder="Example:- plastic, any">
</div>
<div class="mb-3">
  <label for="EditBrand" class="form-label">Product Brand</label>
  <input type="text" class="form-control" id="EditBrand" placeholder="Example:- samsung, lenovo">
</div>
<div class="mb-3">
  <label for="EditDisc" class="form-label">Product Discription</label>
  <textarea class="form-control" id="EditDisc" rows="3"></textarea>
</div>

<button type="button" id="EditBtn" class="btn btn-primary ">Edit</button>
</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

    <div class="limiter" style="display:block;" id="loginSection">
        <div class="container-login100">
            <div class="wrap-login100">
                <form class="login100-form validate-form" action="#">
                    <span class="login100-form-title p-b-26">
Welcome
</span>
                    <span class="login100-form-title p-b-48">
<i class="zmdi zmdi-font"></i>
</span>
                    <div class="wrap-input100 validate-input">
                        <input class="input100" id="mobileNumber" type="tel" >
                        <span class="focus-input100" data-placeholder="Mobile Number"></span>
                    </div>
                    <div class="wrap-input100 validate-input" data-validate="Enter password">
                        <span class="btn-show-pass">
<i class="zmdi zmdi-eye"></i>
</span>
                        <input class="input100" id="password" type="password" name="pass">
                        <span class="focus-input100" data-placeholder="Password"></span>
                    </div>
                    <div class="container-login100-form-btn">
                        <div class="wrap-login100-form-btn">
                            <div class="login100-form-bgbtn"></div>
                            <button class="login100-form-btn" id="submitBtn">
											Login
							</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div id="dropDownSelect1"></div>
	
	<div id="AdminPanel" style="display:none;">
	
	<div class="container g-3">
<center>
  <h1>Add Products</h1>
</center>
<label>Select Product Categories</label>
<select class="form-select form-select-sm" id="categorySelect" aria-label="Small select example">
  <option selected>All</option>
  <option value="Laptop">Laptop</option>
  <option value="Computer">Computer</option>
  <option value="Camera">Camera</option>
   <option value="Mobile">Mobile</option>
     <option value="Assesories">Assesories</option>
</select>
<div class="mb-3">
  <label for="ProductName" class="form-label">Product Name</label>
  <input type="text" class="form-control" id="ProductName" placeholder="Example:- Mobile, Computer">
</div>
<div class="mb-3">
  <label for="ProductPrice" class="form-label">Product Price</label>
  <input type="tel" class="form-control" id="ProductPrice" placeholder="Example:- 100">
</div>
<div class="mb-3">
  <label for="ProductType" class="form-label">Product Type</label>
  <input type="text" class="form-control" id="ProductType" placeholder="Example:- wired, wireless">
</div>
<div class="mb-3">
  <label for="ProductColor" class="form-label">Product Color</label>
  <input type="text" class="form-control" id="ProductColor" placeholder="Example:- white, black">
</div>
<div class="mb-3">
  <label for="ProductMetarial" class="form-label">Product Material</label>
  <input type="text" class="form-control" id="ProductMetarial" placeholder="Example:- plastic, any">
</div>
<div class="mb-3">
  <label for="ProductBrand" class="form-label">Product Brand</label>
  <input type="text" class="form-control" id="ProductBrand" placeholder="Example:- samsung, lenovo">
</div>
<div class="mb-3">
  <label for="ProductFile" class="form-label">Product Image</label>
  <input type="file" class="form-control" id="ProductFile" >
</div>
<div class="mb-3">
  <label for="ProductDisc" class="form-label">Product Discription</label>
  <textarea class="form-control" id="ProductDisc" rows="3"></textarea>
</div>
<button type="button" id="ProductAddBtn" class="btn btn-primary ">Add</button>
</div>
</div>

<div class="container">
<center>
<h1>All Product's See Here..</h1>
</center>

<div id="ProductPage" style="position:absolute; display:flex; flex-wrap:wrap;">

</div>

</div>
	
	</div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
 

   <script type="module">
   
   

   let base64Image
   // Selecting DOM elements
const AdminPanel = document.querySelector("#AdminPanel");
const loginSection = document.querySelector("#loginSection");
const submitButton = document.querySelector("#submitBtn");

const ProductName = document.getElementById("ProductName");
const ProductPrice = document.getElementById("ProductPrice");
const ProductType = document.getElementById("ProductType");
const ProductColor = document.getElementById("ProductColor");
const ProductMetarial = document.getElementById("ProductMetarial");
const ProductBrand = document.getElementById("ProductBrand");
const ProductFile = document.getElementById("ProductFile");


const ProductAddBtn = document.getElementById("ProductAddBtn");
const ProductPage = document.getElementById("ProductPage");
const imageInput = document.getElementById('ProductFile');

// Firebase imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
import { getDatabase, ref, onValue, remove, set, push, update } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";

// Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyDlMh1nW65TSixHJqf5eztacnIh4gY7kik",
  authDomain: "shiv-computer-f9447.firebaseapp.com",
  projectId: "shiv-computer-f9447",
  storageBucket: "shiv-computer-f9447.appspot.com",
  messagingSenderId: "173874985306",
  appId: "1:173874985306:web:cb8ee29262df1252d39b63",
  measurementId: "G-1E9D53LRQ5"
};
	   
// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const database = getDatabase(app);

submitButton.addEventListener("click", async function (e) {
  e.preventDefault();
  const mobileNumber = document.getElementById("mobileNumber").value + "@gmail.com";
  const password = document.getElementById("password").value;

  try {
    const userCredential = await signInWithEmailAndPassword(auth, mobileNumber, password);
    const user = userCredential.user;
    console.log("Success! Welcome back!");
    alert("Login Successfully! Welcome back!");
  

 loginSection.style.display = "none";
    AdminPanel.style.display = "block";


    // Local storage for the uploaded image
    imageInput.addEventListener("change", function () {
      if (imageInput.files.length > 0) {
        const file = imageInput.files[0];
        const reader = new FileReader();
        reader.onload = function (e) {
          base64Image = e.target.result;
          localStorage.setItem('storedImage', base64Image);
        };
        reader.readAsDataURL(file);
      } else {
        alert('Please select an image.');
      }
    });
	
	
 const categorySelect = document.getElementById("categorySelect");

        // Add an event listener to listen for changes in the select element
        categorySelect.addEventListener("change", function() {
            // Get the selected category value
            const selectedCategory = categorySelect.value;

            // Display the selected category in the console
            console.log("Selected category: " + selectedCategory);
        });

    // Function to submit the form
    function submitForm(e) {
      e.preventDefault();
      const Name = ProductName.value;
      const Price = ProductPrice.value;
	  const Color = ProductColor.value;
	  const Brand = ProductBrand.value;
	  const Material = ProductMetarial.value;
	  const Disc = ProductDisc;
	  const Categories = categorySelect.value;
      let Image = base64Image

      if (Name && Price) {
        const usersRef = push(ref(database, "Products"));
        set(usersRef, {
          ProductName: Name,
          ProductPrice: Price,
		  ProductColor: Color,
		  ProductBrand: Brand,
		  ProductMetarial: Material,
		  ProductDisc: Disc,
		  ProductCategories: Categories,
          ProductImage: base64Image
        }).then(() => {
          alert("Product Added Successfully");
          localStorage.clear();
        }).catch((error) => {
          alert("Product Not Added", error);
        });
      } else {
        alert("Please enter both a Name and a Price.");
      }
    }

    ProductAddBtn.addEventListener("click", submitForm);

    let UserName = "Products";
    onValue(ref(database, UserName), (snapshot) => {
      ProductPage.innerHTML = ""; // Clear the previous content

      snapshot.forEach((childSnapshot) => {
        const childData = childSnapshot.val();
        const Name = childData.ProductName;
        const Price = childData.ProductPrice;
        const Image = childData.ProductImage;
        const documentId = childSnapshot.key;

        // Display data in the HTML
        ProductPage.innerHTML += `
          <div class="card my-3 mx-3" style="width: 150px;">
            <img src="${Image}" class="card-img-top" alt="">
            <div class="card-body">
              <h5 class="card-title">${Name}</h5>
              <h2 class="card-text">${Price}</h2>
              <a href="#" class="btn btn-danger" data-document-id="${documentId}" id="delBtn">Delete</a>
              <a href="#" class="btn btn-success my-1" data-document-id="${documentId}" id="editBtn"  data-bs-toggle="modal" data-bs-target="#exampleModal">Edit</a>
            </div>
          </div>
        `;
      });

      // Event listener for delete buttons
      const deleteButtons = document.querySelectorAll("#delBtn");
      deleteButtons.forEach((btn) => {
        btn.addEventListener("click", (event) => {
          const documentIdToDelete = event.target.getAttribute("data-document-id");
          if (documentIdToDelete) {
            const documentRefToDelete = ref(database, `${UserName}/${documentIdToDelete}`);
            deleteDoc(documentRefToDelete);
          }
        });
      });

      // Event listener for edit buttons
      const editButtons = document.querySelectorAll("#editBtn");
      editButtons.forEach((btn) => {
        btn.addEventListener("click", (event) => {
          const documentIdToEdit = event.target.getAttribute("data-document-id");
          if (documentIdToEdit) {
             let ProductRef = ref(database, `Products/${documentIdToEdit}`);
			
			const EditName = document.getElementById("EditName");
			const EditPrice = document.getElementById("EditPrice");
			const EditType = document.getElementById("EditType");
			const EditColor = document.getElementById("EditColor");
			const EditMetarial = document.getElementById("EditMetarial");
			const EditBrand = document.getElementById("EditBrand");
			let EditDisc = document.getElementById("EditDisc");
			let EditFilePreview = document.getElementById("EditFilePreview");
		
			 onValue(ProductRef, (snapshot)=>{
			    let data = snapshot.val();
				
				EditName.value = data.ProductName;
				EditPrice.value = data.ProductPrice;
				EditColor.value = data.ProductColor;
				EditBrand.value = data.ProductBrand;
				EditMetarial.value = data.ProductMetarial;
				EditType.value = data.ProductType;
				EditDisc.value = data.ProductDisc;
				EditFilePreview.src = data.ProductImage;
				
			 })
			 
			 
			  let EName = EditName.value;
			  let EPrice = EditPrice.value;
			  let EColor = EditColor.value;
			  let EBrand = EditBrand.value;
			  let EMaterial = EditMetarial.value;
			  let EType = EditType.value;
				 
			 
			  const editBtn = document.getElementById("EditBtn");
        EditBtn.addEventListener('click', async () => {
		
          await update(ref(database, `Products/${documentIdToEdit}`), {
            ProductName: EditName.value,
            ProductPrice: EditPrice.value,
			ProductColor: EditColor.value,
			ProductBrand: EditBrand.value,
			ProductMetarial: EditMetarial.value,
			ProductType: EditType.value,
			ProductDisc: EditDisc
          });
          alert("Product Edit successfully");
		   localStorage.clear();
        });
      
		  }
		  else{
		    alert("find some error");
		  }
        });
      });
    });	

    // Function to delete a document
    async function deleteDoc(docRef) {
      try {
        await remove(docRef);
        alert("Document successfully deleted!");
      } catch (error) {
        console.error("Document deletion unsuccessful. Please try again!");
      }
    }

   } catch (error) {
    alert("Login Error"+error);
    console.error(error);
  }
}); 
  
   </script>
	
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  
  
 
</body>

</html>
